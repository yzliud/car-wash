<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>工作</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.7 -->
  <link rel="stylesheet" href="${SPATH}/bootstrap/css/bootstrap.min.css">

  <!-- Theme style -->
  <link rel="stylesheet" href="${SPATH}/dist/css/AdminLTE.min.css">
  <link rel="stylesheet" href="${SPATH}/css/weui.css">
    <link rel="stylesheet" href="${SPATH}/css/example.css">
    <link rel="stylesheet" href="${SPATH}/layer.mobile-v2.0/layer_mobile/need/layer.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="hold-transition  sidebar-mini" >
<form id="editForm" method="post" action="${CPATH}/wash/work/forwardWork">
   
  <div class="content-wrapper" style="overflow-x:hidden">

  <div class="row" style="height: 175px;">

        <div class="col-md-4">
          <div class="box box-widget widget-user" style="background-color:#00a7d0 !important">
            <div class="widget-user-header bg-aqua-active" style="height:100px">
            </div>
            <div class="widget-user-image"  style="top: 10px;width:90px;height:90px">
              <img class="img-circle" src="${washMember.img!}" alt="User Avatar">
            </div>
			<div class="row" align="center" style="color:white;margin-top: 5px;">
			 <h3 class="widget-user-username">${washMember.nickName!}</h3>
			</div>
			<div class="row" align="center" style="color:white">
			<h5 class="widget-user-desc">
			好评数:<span style="font-size:20px">${highPraiseCount!0}&nbsp;&nbsp;</span> 
			差评数:<span style="font-size:20px">${badPraiseCount!0}</span>
			 </h5>
			</div>
          </div>
        </div>
        </div>


	<div class="row">
        <div class="col-lg-3 col-xs-6" style="padding-right: 5px;">
          <!-- small box -->
          <div class="small-box bg-aqua" style="margin-bottom: 5px;">
          <div class="inner" style="padding-top: 5px;padding-bottom: 0px;">
              <h3 style="margin-bottom: 0px;">${yesterdayCount!0}</h3>

              <p>昨日订单数</p>
            </div>
            <a href="javascript:toTypeOrder(1);" class="small-box-footer">
              More info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6" style="padding-left: 5px;">
          <!-- small box -->
          <div class="small-box bg-green" style="margin-bottom: 5px;">
            <div class="inner" style="padding-top: 5px;padding-bottom: 0px;">
              <h3 style="margin-bottom: 0px;">${lastWeekCount!0}</h3>

              <p>近7日订单数</p>
            </div>
            <a href="javascript:toTypeOrder(3);" class="small-box-footer">
              More info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6" style="padding-right: 5px;">
          <!-- small box -->
          <div class="small-box bg-yellow" style="margin-bottom: 5px;">
            <div class="inner" style="padding-top: 5px;padding-bottom: 0px;">
              <h3 style="margin-bottom: 0px;">${nowCount!0}</h3>

              <p>今日订单数</p>
            </div>
            <a href="javascript:toTypeOrder(2);" class="small-box-footer">
              More info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6" style="padding-left: 5px;">
          <!-- small box -->
          <div class="small-box bg-red" style="margin-bottom: 5px;">
            <div class="inner" style="padding-top: 5px;padding-bottom: 0px;">
              <h3 style="margin-bottom: 0px;">${waitCount!0}</h3>

              <p>排队订单</p>
            </div>
            <a href="javascript:toOrder();" class="small-box-footer">
              More info <i class="fa fa-arrow-circle-right"></i>
            </a>
          </div>
        </div>
      </div>

</div>
<#if jsonResult.rtnCode == 11>
      <div style="width: 100%;position: fixed; bottom: 0px;font-weight: bold;text-align: center;background-color: #00d01a;color: white; border: 1px solid #00d01a;height:50px;line-height:50px;margin: auto;margin-top: 30px" onclick="startWork()">上班</div>
   <#elseif jsonResult.rtnCode == 10>
   <div style="width: 100%;position: fixed; bottom: 0px;font-weight: bold;text-align: center;background-color: #f5104f;color: white; border: 1px solid #f5104f;height:50px;line-height:50px;margin: auto;margin-top: 30px" onclick="endWork()">下班</div>
   <#elseif jsonResult.rtnCode == 20>
   <div style="width: 100%;position: fixed; bottom: 0px;font-weight: bold;text-align: center;background-color: #00a7d0;color: white; border: 1px solid #00a7d0;height:50px;line-height:50px;margin: auto;margin-top: 30px" onclick="toOrder()">打开设备</div>
   </#if> 
      </div>
   <input type="hidden" id="device_mac" name="device_mac" value="${device_mac!}"> 
  </form>
<!-- jQuery 2.2.3 -->
<script src="${SPATH}/js/jquery-2.2.3.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="${SPATH}/bootstrap/js/bootstrap.min.js"></script>
<script src="${SPATH}/js/zepto.min.js"></script>
<script type="text/javascript" src="${SPATH}/js/jweixin-1.0.0.js"></script>
<script src="${SPATH}/js/weui.min.js"></script>
<script src="${SPATH}/js/example.js"></script>
<script src="${SPATH}/layer.mobile-v2.0/layer_mobile/layer.js"></script>
<script>
function startWork(){
			$.ajax({
	            url:"${CPATH}/wash/work/startWork",
	            data:$("#editForm").serialize(),
	            type:"post",
	            async: false,
	            //dataType: 'json',
	            success:function(data){//ajax返回的数据
	            	console.log('data'+data);
	           		 if(data.rtnCode==0){
	           			layer.open({
	           			    content: data.rtnMsg
	           			    ,btn: '确定'
           			    	,yes: function(index){
           			    		$("#editForm").submit();
	           			    }
	           			  });
	           	 	}else{
	           	 	layer.open({
           			    content: data.rtnMsg
           			    ,btn: '确定'
           			  });
	           	 	}
	            }
	       }); 
}

function endWork(){
	layer.open({
	    content: '确定现在下班？'
	    ,btn: ['是', '否']
	    ,yes: function(index){
	    	$.ajax({
	            url:"${CPATH}/wash/work/endWork",
	            data:$("#editForm").serialize(),
	            type:"post",
	            async: false,
	            //dataType: 'json',
	            success:function(data){//ajax返回的数据
	            	console.log('data'+data);
	           		 if(data.rtnCode==0){
	           			layer.open({
	           			    content: data.rtnMsg
	           			    ,btn: '确定'
           			    	,yes: function(index){
           			    		window.location.href = "${CPATH}/wash/order/forwardHis";
	           			    }
	           			  });
	           		
	           	 	}else{
	           	 	layer.open({
	       			    content: data.rtnMsg
	       			    ,btn: '确定'
	       			  });
	           	 	}
	            }
	       }); 
	    }
	  });

}

function toOrder(){
	window.location.href = "${CPATH}/wash/order/forwardWork";
}
function toOrderHis(){
	window.location.href = "${CPATH}/wash/order/forwardHis";
}

function toTypeOrder(str){
	window.location.href = "${CPATH}/wash/order/forwardTypeHis?type="+str;
}

</script>
</body>
</html>
