<!DOCTYPE html>
<!-- saved from url=(0016)https://weui.io/ -->
<html lang="zh-cmn-Hans"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>车牌绑定</title>
    <link rel="stylesheet" href="${SPATH}/css/weui.css">
    <link rel="stylesheet" href="${SPATH}/css/example.css">
    <link rel="stylesheet" href="${SPATH}/layer.mobile-v2.0/layer_mobile/need/layer.css">
    <link rel="stylesheet" type="text/css" href="${SPATH}/carnumber/css/jquery.css"/>
</head>
 <body>
 <div>
    <div class="page__bd">

        <div class="weui-cells weui-cells_form">
            <div class="weui-cell">
                <div class="weui-cell__hd">
                	<label class="weui-label">车牌号</label>
                </div>
                <div class="weui-cell__bd">
                    <input class="weui-input" id="car_name" name="car_name" value="${washMember.carNumber!}" type="text" placeholder="请输入车牌号"/>
                </div>
            </div>
            <div class="weui-cell">
                <div class="weui-cell__hd">
                    <label class="weui-label">车辆型号</label>
                </div>
                <div class="weui-cell__bd">
                    <input class="weui-input" id="car_model" name="car_model" value="${washMember.carModel!}" type="text" placeholder="请输入车辆型号"/>
                </div>
            </div>
            
        </div>
        
        <div class="weui-btn-area">
            <a class="weui-btn weui-btn_primary" href="javascript:update();" id="showTooltips">提交</a>
        </div>
    </div>
</div>
<script src="${SPATH}/js/zepto.min.js"></script>
<script type="text/javascript" src="${SPATH}/js/jweixin-1.0.0.js"></script>
<script src="${SPATH}/js/weui.min.js"></script>
<script src="${SPATH}/js/example.js"></script>
<script src="${SPATH}/layer.mobile-v2.0/layer_mobile/layer.js"></script>
<script type="text/javascript" src="${SPATH}/carnumber/js/jquery.min.js"></script>
<!--
如果您要调用的高版本jQuery，请引用下面jQuery版本迁移辅助插件
<script src="http://www.jq22.com/jquery/jquery-migrate-1.2.1.min.js"></script>
-->
<script src="${SPATH}/carnumber/js/jquery.autocomplete.js" type="text/javascript"></script>
<script src="${SPATH}/carnumber/js/data.js" type="text/javascript"></script>
<script src="${SPATH}/carnumber/js/autocomplete.js" type="text/javascript"></script>
<script src="${SPATH}/carnumber/js/index.js" type="text/javascript"></script>
<script>
function update(){
	var car_name = $("#car_name").val().toUpperCase();
	if(car_name == "输入车牌" || car_name == "") {
		layer.open({
			content: '请输入车牌',
			skin: 'msg',
			time: 2
		});
	} else if(check_car_name(car_name) == false) {
		layer.open({
			content: '请输入正确车牌',
			skin: 'msg',
			time: 2
		});
	} else {
		$.ajax({
	        url:"${CPATH}/car/member/editUserInfo",
	        data:{
	        	"car_number": car_name,
	        	"car_model": $("#car_model").val()
	        },
	        type:"post",
	        async: false,
	        dataType: 'json',
	        success:function(data){//ajax返回的数据
	       		 if(data.rtnCode==0){
	       			layer.open({
	       				content: '操作成功',
	       				skin: 'msg',
	       				time: 2,
	       				end: function(){
	       					window.location.href = "${CPATH}/car/member/forwardUserCenter";
	       				  }
	       			});
	       	 	}else{
		       	 	layer.open({
		    			content: '操作失败',
		    			skin: 'msg',
		    			time: 2
		    		});
	       	 	}
	        }
	   }); 
	}
}

function check_car_name(car_name) {
	var re = /^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/;
	if(car_name.search(re) == -1) {
		return false;
	} else {
		return true;
	}
}
</script>

 </body>
</html>