<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>购买</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.7 -->
  <link rel="stylesheet" href="${SPATH}/bootstrap/css/bootstrap.min.css">

  <!-- Theme style -->
  <link rel="stylesheet" href="${SPATH}/dist/css/AdminLTE.min.css">
  <link rel="stylesheet" href="${SPATH}/css/weui.css">
    <link rel="stylesheet" href="${SPATH}/css/example.css">
      <link rel="stylesheet" href="${SPATH}/awesome/4.4/css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="${SPATH}/carnumber/css/jquery.css"/>
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="hold-transition  sidebar-mini">
<form id="editForm" method="post" action="${CPATH}/car/order/pay">
<div class="wrapper">

 <div class="col-xs-12" style="padding-left: 0px;padding-right: 0px;">
          <div class="box box-solid" style="margin-bottom: 0px;">
            <div class="box-body" style="padding-left: 0px;padding-top: 0px;padding-bottom: 0px;padding-right: 0px;">
              <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  <div class="item active">
                    <img src="http://placehold.it/900x500/39CCCC/ffffff&text=I+Love+Bootstrap" alt="First slide">

                    <div class="carousel-caption">
                      
                    </div>
                  </div>
                </div>
                <a class="left carousel-control" href="#carousel-example-generic" data-slide="prev">
                </a>
                <a class="right carousel-control" href="#carousel-example-generic" data-slide="next">
                </a>
              </div>
            </div>
          </div>
        </div>

</div>
<div class="weui-cells__title">手机号</div>
        <div class="weui-cells">
            <div class="weui-cell">
                <div class="weui-cell__bd">
                    <input class="weui-input" type="text" id="mobile" name="mobile" value="${washMember.mobile!}" readonly/>
                </div>
            </div>
        </div>
        <div class="weui-cells__title">车牌号</div>
        <div class="weui-cells">
            <div class="weui-cell">
                <div class="weui-cell__bd">
                    <input class="weui-input" id="car_name" name="car_name" type="text" value="${washMember.carNumber!}" placeholder="请输入车牌号"/>
                </div>
            </div>
        </div>
<div class="row" style="margin-top: 10px;">
				 	 <div class="col-md-3 col-sm-6 col-xs-12">
			          <div class="info-box ">
			            <span class="info-box-icon"><i class="fa fa-shopping-cart"></i></span>
			
			            <div class="info-box-content">
			              <span class="info-box-text"> ${washSetMealData.name!} ${washSetMealData.salePrice!0}元</span>
			              <span class="info-box-number"> 总计：${realFee!0}元</span>
			
			
			                  <span class="progress-description">
			                    抵用金额：${discountFee!0}元
			                  </span>
			            </div>
			          </div>
			        </div>
				 </div>
         <div style="width: 100%;position: fixed; bottom: 0px;font-weight: bold;text-align: center;background-color: #00a7d0;color: white; border: 1px solid #00a7d0;height:50px;line-height:50px;margin: auto;margin-top: 30px" onclick="topay()">确认付款</div>

 <input type="hidden" id="set_meal_id" name="set_meal_id" value="${washSetMealData.id!}"> 
<input type="hidden" id="device_mac" name="device_mac" value="${device_mac!}">

</form>
<!-- jQuery 2.2.3 -->
<!-- Bootstrap 3.3.7 -->
<script src="${SPATH}/bootstrap/js/bootstrap.min.js"></script>
<script src="${SPATH}/js/zepto.min.js"></script>
<script type="text/javascript" src="${SPATH}/js/jweixin-1.0.0.js"></script>
<script src="${SPATH}/js/weui.min.js"></script>
<script src="${SPATH}/js/example.js"></script>
<script src="${SPATH}/layer.mobile-v2.0/layer_mobile/layer.js"></script>
<script type="text/javascript" src="${SPATH}/carnumber/js/jquery.min.js"></script>
<!--
如果您要调用的高版本jQuery，请引用下面jQuery版本迁移辅助插件
<script src="http://www.jq22.com/jquery/jquery-migrate-1.2.1.min.js"></script>
-->
<script src="${SPATH}/carnumber/js/jquery.autocomplete.js" type="text/javascript"></script>
<script src="${SPATH}/carnumber/js/data.js" type="text/javascript"></script>
<script src="${SPATH}/carnumber/js/autocomplete.js" type="text/javascript"></script>
<script src="${SPATH}/carnumber/js/index.js" type="text/javascript"></script>
<script>


function topay(){
	var car_name = $("#car_name").val().toUpperCase();
	if(car_name == "输入车牌" || car_name == "") {
		layer.open({
			content: '请输入车牌',
			skin: 'msg',
			time: 2
		});
	} else if(check_car_name(car_name) == false) {
		layer.open({
			content: '请输入正确车牌',
			skin: 'msg',
			time: 2
		});
	} else {
		var phonenum = $("#mobile").val();
		var myreg = /^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/;
		if (!myreg.test(phonenum)) {
			layer.open({
				content: '请输入合法手机号!',
				skin: 'msg',
				time: 2
			});
		}else{
			$.ajax({
		        url:"${CPATH}/car/order/check",
		        data:{
		        	"device_mac": $("#device_mac").val()
		        },
		        type:"post",
		        async: false,
		        //dataType: 'json',
		        success:function(data){//ajax返回的数据
		       		if(data.rtnCode==0){
		       			$("#editForm").submit();
		       	 	}else{
			       	 	layer.open({
			    			content: data.rtnMsg,
			    			skin: 'msg',
			    			time: 2
			    		});
		       	 	}
		        }
		   });
		}
	}
	
}
</script>
</body>
</html>
